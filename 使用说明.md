# 项目整体结构

[cloudmusic_spider](#项目整体结构)	// workspace
		│	//  Ctrl + 单击 以跳转
		├─ [code](#code)
		│  ├─ [emo](#emo)
		│  │  ├─ [emo_score.py](#emo_score.py)
		│  │  ├─ [neg.txt](#neg.txt)
		│  │  ├─ [pos.txt](#pos.txt)
		│  │  └─ [sentiment.marshal.3](#sentiment.marshal.3)
		│  │
		│  ├─ [playlist](#playlist)
		│  │  ├─ [get_playlist_comments.py](#get_playlist_comments.py)
		│  │  └─ [get_playlist_info.py](#get_playlist_info.py)
		│  │
		│  ├─ [process](#process)
		│  │  ├─ [basic_filiter_xxl.py](#basic_filiter_xxl.py)
		│  │  ├─ [basic_filiter_yk.py](#basic_filiter_yk.py)
		│  │  ├─ [song_rec.py](#song_rec.py)
		│  │  ├─ [upload.py](#upload.py)
		│  │  ├─ [word_count.py](#word_count.py)
		│  │  ├─ [word_cut.py](#word_cut.py)
		│  │  └─ [word_cut_bak.py](#word_cut_bak.py)
		│  │
		│  ├─ [singer](#singer)
		│  │  └─ [get_singer_info.py](#get_singer_info.py)
		│  │
		│  ├─ [song](#song)
		│  │  ├─ [get_song_comments.py](#get_song_comments.py)
		│  │  ├─ [get_song_info.py](#get_song_info.py)
		│  │  ├─ [get_song_lyric.py](#get_song_lyric.py)
        │  │  └─ [get_song_tag.py](#get_song_tag.py)
        │  │
        │  ├─ [spider](#spider)
        │  │  └─ [Singles_chart.py](#Singles_chart.py)	// 爬虫入口
        │  │
        │  ├─ [tools](#tools)
        │  │  ├─ [comment.py](#comment.py)
        │  │  ├─ [file.py](#file.py)
        │  │  ├─ [post_params.py](#post_params.py)
        │  │  ├─ [progressBar.py](#progressBar.py)
        │  │  ├─ [request.py](#request.py)
        │  │  ├─ [sleep.py](#sleep.py)
        │  │  ├─ [stop_words.txt](#stop_words.txt)
        │  │  ├─ [struct.py](#struct.py)
        │  │  └─ [utils.py](#utils.py)
        │  │
        │  └─ [user](#user)
        │     ├─ [get_user_info.py](#get_user_info.py)
        │     ├─ [get_user_listen_rank.py](#get_user_listen_rank.py)
        │     └─ [get_user_playlist.py](#get_user_playlist.py)
        │
        ├─ [data](#data)	
        │  ├─ [info](#info)
        │  │  ├─ [playlist_info.txt](#playlist_info.txt)
        │  │  ├─ [singer_info.txt](#singer_info.txt)
        │  │  ├─ [song_info.txt](#song_info.txt)
        │  │  └─ [user_info.txt](#user_info.txt)
        │  │
        │  ├─ [playlist_comments](#playlist_comments)
        │  │  ├─ [playlist_3778678.txt](#playlist_3778678.txt)
        │  │  └─ ...
        │  │
        │  ├─ [rec](#rec)
        │  │  ├─ [rec_1904831431.txt](#rec_1904831431.txt)
        │  │  └─ ...
        │  │
        │  ├─ [song_comments](#song_comments)
        │  │  ├─ [song_1904831431.txt](#song_1904831431.txt)
		│  │  └─ ...
		│  │
		│  └─ [store](#store)
		│     ├─ [playlist_comment_emo.txt](#playlist_comment_emo.txt)
		│     └─ [song_comment_emo.txt](#playlist_comment_emo.txt)
		│
		└─ [README.md](#README.md)

# code

项目代码部分，爬虫入口位于[code/spider/Singles_chart.py](#Singles_chart.py)

## emo

本部分负责训练snownlp情感分析模型&计算各类emo指数

### emo_score.py

该文件负责借助snownlp分析歌词、评论、用户个性签名等一系列可能体现情感的语料，从而计算各类emo指数，具体如下：

- 一首歌的歌词emo指数
- 所有歌曲的歌词emo指数
- 单个评论文件的emo指数
- 所有评论文件的emo指数
- 单个歌曲的emo指数
- 所有歌曲的emo指数
- 单个用户的emo指数
- 所有用户的emo指数
- 单个歌手的emo指数
- 所有歌手的emo指数
- 单个歌单的emo指数
- 所有歌单的emo指数

以上各类emo指数均采用Spark、HDFS进行分析和存储

### neg.txt

用于训练snownlp情感分析模型的消极语料库，其中包含的用户评价emo程度较高

### pos.txt

用于训练snownlp情感分析模型的积极语料库，其中包含的用户评价emo程度较低

### sentiment.marshal.3

通过以上两个语料库训练得到的情感分析模型，可直接使用

在使用中，需要注意修改"**your_path_to_python**\Lib\site-packages\snownlp\sentiment\__init__.py"文件中的：

```python
data_path = os.path.join(os.path.dirname(os.path.abspath(__file__)),
                          'sentiment.marshal')
```

==》'sentiment.marshal'改为本机上到本文件的绝对路径，但**不需要添加后缀".3"**，例如：

```python
data_path = os.path.join(os.path.dirname(os.path.abspath(__file__)),
                          'E:/sentiment.marshal')
```



## playlist

负责歌单相关的信息爬取

### get_playlist_comments.py

负责爬取某一歌单下的评论信息，并返回参与评论的用户id列表以及评论总数

在运行过程中调用[tools](#tools)中的[comment.py](#comment.py)内的工具方法从json中提取相关信息，具体细节可跳转查看[Ctrl + 单击]

使用的歌单评论接口为：

```python
url = f'https://music.163.com/api/v1/resource/comments/A_PL_0_{playlistid}?limit=20&offset={page}'
```

数据爬取结束后暂存于本地的[data/playlist_comments](#playlist_comments)文件夹下，详细信息可跳转查看。

### get_playlist_info.py

负责爬取某一歌单的详细信息，并返回上榜歌曲的id列表。

爬取的信息包括:

- 歌单ID
- 歌单名称
- 播放量
- 收藏量
- 歌单描述
- 歌单标签
- 创建者ID
- 上榜歌曲ID列表
- 歌单收录音乐的数量
- 评论数

以上数据爬取结束后暂存于本地的[data/info/playlist_info.txt](#playlist_info.txt)中，详细信息可跳转查看。

## process

### basic_filiter_xxl.py

### basic_filiter_yk.py

### song_rec.py

负责相似歌曲推荐算法的实现，主要是结合歌曲本身和用户画像，从爬取的歌曲库中筛选出相似歌曲。

算法具体思路详见文档 	[推荐算法.md](推荐算法.md)	[Ctrl + 单击以跳转]

### upload.py

### word_count.py

### word_cut.py

### word_cut_bak.py

## singer

### get_singer_info.py

## song

### get_song_comments.py

### get_song_info.py

### get_song_lyric.py

### get_song_tag.py

## spider

### Singles_chart.py

## tools

### comment.py

### file.py

### post_params.py

### progressBar.py

### request.py

### sleep.py

### stop_words.txt

### struct.py

### utils.py

## user

### get_user_info.py

### get_user_listen_rank.py

### get_user_playlist.py

# data

项目数据部分，用于存储爬取到的数据

## info

### playlist_info.txt

### singer_info.txt

### song_info.txt

### user_info.txt

## playlist_comments

### playlist_3778678.txt

## rec

### rec_1904831431.txt

## song_comments

### song_1904831431.txt

## store

### playlist_comment_emo.txt

### playlist_comment_emo.txt

# README.md

项目说明文档
